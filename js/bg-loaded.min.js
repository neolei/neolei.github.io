(function(a){a.fn.bgLoaded=function(d){var b=this;var e={afterLoaded:function(){this.addClass("bg-loaded")}};var c=a.extend({},e,d);b.each(function(){var g=a(this),f=g.css("background-image").split(", ");b.data("loaded-count",0);a.each(f,function(i,j){var h=j.replace(/^url\(["']?/,"").replace(/["']?\)$/,"");a("<img/>").attr("src",h).load(function(){a(this).remove();b.data("loaded-count",b.data("loaded-count")+1);if(b.data("loaded-count")>=b.length){c.afterLoaded.call(g)}})})})}})(jQuery);